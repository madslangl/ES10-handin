# Code base for Master Thesis
This is the code base for the master thesis made by Mads Lang Laursen in the period February to June 2025.

The code can be used as a supplement to the report, and in most cases, also stand on its own. The dataset generated by the scipts can be downloaded here:
https://www.dropbox.com/scl/fo/ewmh94bew74lqy02p1fb0/AFNBsgEYmQkNmN37IpJuSaY?rlkey=neqra7zr25imcv43lg043ksqd&st=tzwd9lar&dl=0 

It consists of four main folders, all described here:

### 1 - Data Generation
The data generation was done using pyroomacoustics. A large number of rooms were generated automatically based on looping over a dict of values to create rooms from. This include both the dimensions of the rooms, the absorption coefficient of the surface within the rooms, the placement of the reciever and source etc. 
If the code is run now, it generates a small test file, which can be used to check the validity of the data. 
The resulting dataset is in .h5 format.

### 2 - PINN
The PINN (Physics-Informed Neural Network) implementation focuses on predicting Room Impulse Responses (RIRs) by combining deep learning with acoustic wave propagation physics. The codebase includes a complete pipeline with dataset loading, model architectures, training scripts and evaluation tools. The main model (simple_pinn) incorporates physics knowledge through specialized loss functions that enforce wave equation constraints at strategic collocation points around the head model. The implementation supports both stereo and mono audio, with options to include room dimensions and laptop positions as additional inputs. Training can be monitored with various metrics, and pre-trained models can be evaluated on test data using statistics_pred.py or tested on individual samples with predict_rir_local.py.

The PINN is run via the parser, so please run the script through your terminal an give it arguments accordingly.

For training, for example:

```python ./PINN/train.py  --rir_path<RIR_PATH> --models 'PINN/example-models' --checkpoints '/PINN/checkpoints' --split train  --model=simple_pinn --rir_length=500 --room_dims --laptop_pos```

And for testing:

``` python "PINN\predict_rir.py" --models="examples\more-layers-alpha05simple_pinn_step_27000.pth" --rir_path=<RIR_PATH> --split="test" --model="simple_pinn" --rir_length=500 --room_dims --laptop_pos```                     

And lastly for analysing statistics by going through the whole test set:
``` python "PINN\statistics_pred.py" --models="examples\more-layers-alpha05simple_pinn_step_27000.pth" --rir_path=<RIR_PATH> --split="test" --model="simple_pinn" --rir_length=500 --room_dims --laptop_pos```  

Two pretrained models are included in PINN\example_models. These do not perform well. Please refer to the report for an explanation of why.


### 3 - Scattering
The scattering implementation generates acoustic scattering data for a spherical head model using analytical solutions of the wave equation. The code uses spherical functions to calculate how sound waves interact with a spherical object at different frequencies, distances, and angles.
An interpolator is made by sampling a large amount of solutions at these frequencies etc. This can then be tested using the interpolator-tester.py, where a small dataset consisting of unseen points is estimated by interpolation of the sampled dataset.

### 4 - SimulationsForComparingMeasurements
In the report, there is an appendix describing room measurements. The rooms are also simulated, and the results are compared. Four wav files of the simulated RIRs based on the room are also included. The script can also be seen as an example of the DataGeneration script, which essentially does the same, but in much larger quantities.




